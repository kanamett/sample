<!DOCTYPE HTML>
<html>
<head>
<title>PhoneGap Showcase</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8"/>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
<script src="http://code.jquery.com/jquery-1.6.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
</head>
<body>
    <div data-role="page">
        <div data-role="header">
            <h1>Accelerometer Showcase</h1>
        </div>
        <div data-role="content">
            <a id="accelerometer_watch" href="#" data-role="button">計測開始</a>
            <div style="width:100%;height:150px;text-align:center;">
                <div id="accelerometer_watch_word" style="line-height:150px;font-size:100px; "></div>
            </div>
            <div id="accelerometer_watch_status" style="height:100px;width:100px;background-color:#FF0000">a</div>
            <a id="accelerometer_clear" href="#" data-role="button">計測終了</a>
            <div id="accelerometer_watch_status" style="height:100px;width:100px;background-color:#FF0000">a</div>
            <a id="accelerometer_now" href="#" data-role="button">今</a>
	<div id="message">message</span>
        </div>
    </div>
</body>

<script type="text/javascript">

$(function(){
    document.addEventListener("deviceready",
        function(){
            $('#accelerometer_watch').attr('href', 'javascript:watchStartAccelerometer()');
            $('#accelerometer_clear').attr('href', 'javascript:watchStopAccelerometer()');
            $('#accelerometer_now').attr('href', 'javascript:watchNowAccelerometer()');
        },        false);
})
/*
 * 加速度センサー計測開始
 */
var _accelerometer;
function watchNowAccelerometer() {
$('#message').html("watchNowAccelerometer");
getCurrentAcceleration(onSuccess, onError);
}
function watchStartAccelerometer(){
$('#message').html("watchStartAccelerometer");
var options = { frequency: 1000 }; 
     _accelerometer = navigator.accelerometer.watchAcceleration(onSuccess, onError,options);

    function onSuccess(acceleration) { 
$('#message').html("onSuccess");
            $('#accelerometer_watch_status').html(
                      'x:' + acceleration.x + "<br>" +
                      'y:' + acceleration.y + "<br>" +
                      'z:' + acceleration.z + "<br>" +
                      '日付:' + new Date(acceleration.timestamp).toString());
           
            if(Math.abs(acceleration.x)>9){
                $('#accelerometer_watch_word').html("横")
            }else if(Math.abs(acceleration.y)>9){
                $('#accelerometer_watch_word').html("縦")
            }else if(Math.abs(acceleration.z)>9){
                $('#accelerometer_watch_word').html("水平")
            }else{
                 $('#accelerometer_watch_word').html("")
            }
        }
    function onError() { 
$('#message').html("onError");
        }
}
/*
 * 加速度センサー計測終了
 */
function watchStopAccelerometer(){
     navigator.accelerometer.clearWatch(_accelerometer);
     $('#accelerometer_watch_status').html('');
     $('#accelerometer_watch_word').html('');
}
</script>
</html>
